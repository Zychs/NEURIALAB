{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://neurialab.dev/schema/ledgar-base.schema.json",
  "title": "Neurialab Ledger Base Schema",
  "description": "Shared base schema for Neurialab ledgers, ensuring consistent metadata and reusable structures.",
  "type": "object",
  "required": [
    "meta"
  ],
  "properties": {
    "meta": {
      "$ref": "#/$defs/metaBlock"
    },
    "aesthetic_dna": {
      "$ref": "#/$defs/aestheticDNA"
    },
    "semantic_tags": {
      "type": "array",
      "title": "Semantic Tags",
      "items": {
        "$ref": "#/$defs/tagEntry"
      }
    },
    "integration": {
      "$ref": "#/$defs/integrationBlock"
    },
    "entries": {
      "type": "array",
      "description": "Generic ledger entries; child schemas may specialize the structure of each entry.",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "minLength": 1,
            "description": "Stable identifier for the entry."
          },
          "label": {
            "type": "string",
            "description": "Human-readable name for the entry."
          },
          "summary": {
            "type": "string",
            "description": "Short description of the entry intent."
          }
        },
        "additionalProperties": true
      }
    }
  },
  "additionalProperties": true,
  "$defs": {
    "metaBlock": {
      "type": "object",
      "title": "Ledger Metadata",
      "required": [
        "ledger_name",
        "version",
        "author"
      ],
      "properties": {
        "ledger_name": {
          "type": "string",
          "minLength": 1,
          "description": "Canonical ledger name."
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+(\\.\\d+)?$",
          "description": "Semantic version for the ledger definition."
        },
        "author": {
          "type": "string",
          "minLength": 1,
          "description": "Primary author or steward of the ledger."
        },
        "last_updated": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}(:\\d{2})?(Z|[+-]\\d{2}:?\\d{2})$",
          "description": "ISO 8601 timestamp for the last update."
        },
        "description": {
          "type": "string",
          "description": "Optional extended description of the ledger."
        }
      },
      "additionalProperties": true
    },
    "colorHex": {
      "type": "string",
      "pattern": "^#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})$",
      "description": "Hexadecimal color value."
    },
    "aestheticDNA": {
      "type": "object",
      "title": "Aesthetic DNA",
      "properties": {
        "palette": {
          "type": "object",
          "properties": {
            "primaries": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/colorHex"
              },
              "minItems": 1
            },
            "accents": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/colorHex"
              }
            },
            "luminosity_curve": {
              "type": "string"
            }
          },
          "additionalProperties": true
        },
        "texture_profile": {
          "type": "object",
          "properties": {
            "grain_density": {
              "type": "string"
            },
            "paper_fiber_style": {
              "type": "string"
            },
            "bloom": {
              "type": "string"
            },
            "noise_type": {
              "type": "string"
            }
          },
          "additionalProperties": true
        },
        "geometry_signature": {
          "type": "object",
          "properties": {
            "dominant_forms": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "minItems": 1
            },
            "angle_bias": {
              "type": "string"
            },
            "symmetry_type": {
              "type": "string"
            }
          },
          "additionalProperties": true
        },
        "lighting_field": {
          "type": "object",
          "properties": {
            "base_illumination": {
              "type": "string"
            },
            "highlight_color": {
              "$ref": "#/$defs/colorHex"
            },
            "shadow_color": {
              "$ref": "#/$defs/colorHex"
            },
            "gradient_flow": {
              "type": "string"
            }
          },
          "additionalProperties": true
        },
        "animation_intent": {
          "type": "object",
          "properties": {
            "motion_archetype": {
              "type": "string"
            },
            "loop_duration": {
              "type": "string"
            },
            "depth_shift": {
              "type": "string"
            }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    },
    "tagEntry": {
      "type": "object",
      "required": [
        "tag",
        "class"
      ],
      "properties": {
        "tag": {
          "type": "string",
          "minLength": 1,
          "description": "Primary semantic identifier."
        },
        "class": {
          "type": "string",
          "minLength": 1,
          "description": "Category or layer for the tag."
        },
        "visual_pair": {
          "type": "string",
          "description": "Visual motif paired with the tag."
        },
        "meaning": {
          "type": "string",
          "description": "Short description of the tag intent."
        }
      },
      "additionalProperties": true
    },
    "integrationBlock": {
      "type": "object",
      "properties": {
        "tag_ledger_path": {
          "type": "string",
          "minLength": 1,
          "description": "Relative path to a companion tag ledger."
        },
        "overlay_batch_path": {
          "type": "string",
          "minLength": 1,
          "description": "Directory path for batch overlays."
        },
        "glyphic_noise_bg": {
          "type": "string",
          "minLength": 1,
          "description": "Asset path for background glyphic noise."
        }
      },
      "additionalProperties": true
    }
  }
}
